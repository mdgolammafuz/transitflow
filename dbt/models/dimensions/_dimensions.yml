# Dimension Models Configuration
# Pattern: SCD Type 2 - Slowly Changing Dimensions
# Methodical: Aligned with Ingredient B (Spatial) and Contract Enforcement

version: 2

models:
  - name: dim_stops
    description: "Stop dimension with SCD Type 2 history tracking"
    config:
      contract:
        enforced: true
    columns:
      - name: stop_key
        description: "Surrogate key for the dimension"
        data_type: text
        data_tests:
          - unique
          - not_null
          
      - name: stop_id
        description: "Natural key - HSL stop ID"
        data_type: text
        data_tests:
          - not_null
          
      - name: stop_name
        description: "Stop name (may change over time)"
        data_type: text
        data_tests:
          - not_null

      - name: latitude
        description: "Ingredient B: Static Latitude"
        data_type: double precision
        data_tests:
          - not_null

      - name: longitude
        description: "Ingredient B: Static Longitude"
        data_type: double precision
        data_tests:
          - not_null

      - name: zone_id
        description: "Transit zone identifier"
        data_type: text

      - name: stop_code
        description: "Short human-readable stop code"
        data_type: text
          
      - name: valid_from
        description: "Start date of this version"
        data_type: timestamp
        data_tests:
          - not_null
          
      - name: valid_to
        description: "End date of this version (2099-12-31 if current)"
        data_type: timestamp
        data_tests:
          - not_null
          
      - name: is_current
        description: "Flag indicating current version"
        data_type: boolean
        data_tests:
          - not_null
          - accepted_values:
              values: [true, false]
              quote: false
              
  - name: dim_lines
    description: "Transit line dimension with SCD Type 2 history"
    config:
      contract:
        enforced: true
    columns:
      - name: line_key
        data_type: text
        data_tests:
          - unique
          - not_null
          
      - name: line_id
        data_type: text
        data_tests:
          - not_null

      - name: line_name
        data_type: text

      - name: line_type
        data_type: text

      - name: operator_name  # Contract Alignment: Added to match SQL output
        data_type: text

      - name: valid_from
        data_type: timestamp

      - name: valid_to
        data_type: timestamp
          
      - name: is_current
        data_type: boolean
        data_tests:
          - not_null