version: 2

models:
  - name: int_vehicle_journeys
    description: "Sessionized vehicle journeys with aggregated metrics"
    columns:
      - name: vehicle_id
        data_tests:
          - not_null
      - name: journey_id
        description: "Unique journey identifier"
        data_tests:
          - not_null
          - unique
      - name: event_count
        description: "Number of telemetry events in journey"
        data_tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 10000
              
  - name: int_stop_performance
    description: "Stop-level performance metrics for ML features"
    columns:
      - name: stop_id
        data_tests:
          - not_null
      - name: line_id
        data_tests:
          - not_null
      - name: hour_of_day
        data_tests:
          - not_null
      - name: day_of_week
        data_tests:
          - not_null
      - name: sample_count
        description: "Historical count of arrivals in this bucket"
        data_tests:
          - not_null
      - name: historical_avg_delay
        data_tests:
          - not_null
      - name: historical_stddev_delay
        description: "Placeholder for standard deviation of delay"
      - name: avg_dwell_time_ms
        description: "Average time spent at the stop in milliseconds"
      - name: on_time_percentage
        description: "Historical on-time performance percentage"
      - name: latitude
        description: "Ingredient B: Latitude from Spark enrichment"
        data_tests:
          - not_null
      - name: longitude
        description: "Ingredient B: Longitude from Spark enrichment"
        data_tests:
          - not_null